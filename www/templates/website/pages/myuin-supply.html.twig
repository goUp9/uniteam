{% extends "base.html.twig" %}
{% block content %}   
    <div id="wrapper">
        {% include 'commons/header.html.twig'%}
    <main>     
        <h1>My uin - Supplying</h1> 
        {% include 'commons/myuin-nav.html.twig'%} 
        <div clickable class="btn__new">
            <p><a href="{{link.home.href}}" class="nostyle">Create a new Supply query</a></p>
        </div>        
        <div id="queries" ng-controller="SupplyCtrl as ask">
            <table class="outer">
                <tr>
                    <th class="tcell__what"></th>
                    <th class="tcell__where"></th>
                    <th class="tcell__when"></th>
                    <th>Additional</th>
                </tr>
                <tr ng-repeat="query in queries">
                    <td>
                         <div class="tcell__what"></div>
                        <table class="inner">
                            <tr ng-repeat="tags in query.whats">
                                <td>{{ '{{tags.tag.tag}}' }}</td>                                
                            </tr> 
                            <tr>
                                <td class="btn__edit"><div clickable><a class="nostyle" href="{{link.myuin__edit_what.href}}?query_id={{ '{{query.id}}' }}&type=supplying">Edit</a></div></td>
                            </tr>
                        </table>                        
                    </td>
                    <td>
                        <div class="tcell__where"></div>
                        <table class="inner"> 
                            <tr><p ng-if="query.wheres.length<1">Anywhere</p></tr>
                            <tr ng-repeat="locations in query.wheres">
                                <td>
                                    <p>Within {{ '{{locations.radius}}' }} miles of
                                <br/>
                                {{ '{{locations.place.formattedAddress}}' }}
                                    </p></td>
                                
                                <td class="btn__edit"><div clickable><a class="nostyle" href="{{link.myuin__edit_where.href}}?query_id={{ '{{query.id}}' }}&place_id={{ '{{locations.place.placeId}}' }}&type=supplying&query_where_id={{'{{locations.id}}'}}">Edit</a></div></td>
                                <td class="btn__delete"><div ng-click="ask.remove_loc($index)">Remove</div></td>
                            </tr> 
                            <tr>
                                <td class="btn__add"><div clickable><a class="nostyle" href="{{link.myuin__edit_where.href}}?query_id={{ '{{query.id}}' }}&type=supplying">+ Add new location</a></div></td>
                            </tr>
                        </table>                      
                    </td>
                    <td>
                        <div class="tcell__when"></div>
                        <table class="inner">
                            <tr ng-repeat="schedule in query.QueryWhenSchedule">
                                <td>{{ '{{schedule.weekDay}}' }}: from {{ '{{schedule.from}}' }} to {{ '{{schedule.to}}' }}</td>                                
                            </tr> 
                            <tr>
                                <td class="btn__edit"><div clickable><a class="nostyle" href="{{link.myuin__edit_schedule.href}}?query_id={{ '{{query.id}}' }}">Edit</a></div></td>
                            </tr>
                        </table>                          
                    </td>
                    <td>
                        <table class="inner">
                            <tr>
                                <td><p>experience: {{'{{query.finalSupplier.experience}}'}}</p><p>qualification: {{'{{query.finalSupplier.qualifName}}'}}</p></td>                                
                            </tr> 
                            <tr>
                                <td class="btn__edit"><div clickable><a class="nostyle" href="{{link.edit_supply_final.href}}?query_id={{ '{{query.id}}' }}">Edit</a></div></td>
                            </tr>
                        </table>                          
                    </td>
                </tr>
            </table>
        </div>   
    </main>
    <div id="push-footer"></div>    
    </div>
{% endblock %}